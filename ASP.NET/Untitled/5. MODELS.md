## 5. Models

### 5.1 Definição de Models

**Teoria:**  
Models representam os dados e a lógica de negócios da aplicação. São classes C# que:

- Definem a estrutura dos dados
- Implementam regras de validação
- Podem interagir com o banco de dados
- Frequentemente refletem tabelas do banco de dados

### 5.2 Data Annotations

**Teoria:**  
Data Annotations são atributos que decoram propriedades de models para:

- Definir regras de validação
- Formatar dados para exibição
- Configurar o mapeamento para o banco de dados
- Personalizar mensagens de erro

### 5.3 ViewModels

**Teoria:**  
ViewModels são classes específicas que:

- Contêm apenas os dados necessários para uma view específica
- Podem combinar dados de múltiplos models
- Ajudam a evitar a exposição desnecessária de dados
- Facilitam a validação contextual

### 5.4 Prática: Implementando Models e ViewModels

**Prática:**

1. **Criar um model básico:**
    
    csharpresponse-action-icon
    
    ```csharp
    // Models/Product.cs
    namespace MeuProjeto.Models
    {
        public class Product
        {
            public int Id { get; set; }
            public string Name { get; set; }
            public decimal Price { get; set; }
            public string Description { get; set; }
        }
    }
    ```
    
2. **Model com validações (Data Annotations):**
    
    csharpresponse-action-icon
    
    ```csharp
    // Models/Customer.cs
    using System.ComponentModel.DataAnnotations;
    
    namespace MeuProjeto.Models
    {
        public class Customer
        {
            public int Id { get; set; }
            
            [Required(ErrorMessage = "O nome é obrigatório")]
            [StringLength(100, MinimumLength = 2, ErrorMessage = "O nome deve ter entre 2 e 100 caracteres")]
            public string Name { get; set; }
            
            [Required(ErrorMessage = "O e-mail é obrigatório")]
            [EmailAddress(ErrorMessage = "E-mail inválido")]
            public string Email { get; set; }
            
            [Phone(ErrorMessage = "Telefone inválido")]
            [Display(Name = "Telefone")]
            public string PhoneNumber { get; set; }
            
            [DataType(DataType.Date)]
            [Display(Name = "Data de Nascimento")]
            public DateTime BirthDate { get; set; }
        }
    }
    ```
    
3. **Criar um ViewModel:**
    
    csharpresponse-action-icon
    
    ```csharp
    // ViewModels/ProductDetailsViewModel.cs
    namespace MeuProjeto.ViewModels
    {
        public class ProductDetailsViewModel
        {
            public Product Product { get; set; }
            public List<Product> RelatedProducts { get; set; }
            public bool IsInStock { get; set; }
            public int ReviewCount { get; set; }
            
            // Propriedades calculadas
            public string FormattedPrice => Product?.Price.ToString("C");
            public string StockStatus => IsInStock ? "Em estoque" : "Fora de estoque";
        }
    }
    ```
    
4. **Usando um ViewModel no controller:**
    
    csharpresponse-action-icon
    
    ```csharp
    // Controllers/ProductController.cs
    public IActionResult Details(int id)
    {
        // Buscar o produto do banco de dados (simulado aqui)
        var product = GetProductById(id);
        if (product == null)
            return NotFound();
        
        // Buscar produtos relacionados
        var relatedProducts = GetRelatedProducts(product.CategoryId);
        
        // Verificar estoque (simulado)
        bool isInStock = CheckInventory(id) > 0;
        
        // Contar avaliações (simulado)
        int reviewCount = GetReviewCount(id);
        
        // Criar e preencher o ViewModel
        var viewModel = new ProductDetailsViewModel
        {
            Product = product,
            RelatedProducts = relatedProducts,
            IsInStock = isInStock,
            ReviewCount = reviewCount
        };
        
        // Passar o ViewModel para a view
        return View(viewModel);
    }
    ```